/* Copyright (C) 2014 Justin Windle, http://soulwire.co.uk */
var fit=function(){"use strict";function t(t){return t.toUpperCase()}function e(t){return"number"==typeof t&&!isNaN(t)}function n(){return(new Date).getTime()}function i(t,e){for(var n=[],i=0,r=t.length;r>i;i++)n[i]=e(t[i]);return n}function r(t,e){for(var n in e)n in t||(t[n]=e[n]);return t}function o(e){if(!y)for(var n,i=M(H.body),r=w,o=0,a=T.length;a>o&&(y=T[o],n=y+r,!(n in i))&&(y=y.replace(/^(\w)/,t),n=y+r,!(n in i));o++);return y+e}function a(t){var e=M(t),n=e[o(w)].replace(/[a-z()]/gi,"").split(",");if(n.length<6)return[1,0,0,1,0,0];for(var i=0;6>i;i++)n[i]=parseFloat(n[i]);return n}function f(t,e){var n=a(e);n[0]=t.scale,n[3]=t.scale,n[4]+=t.tx,n[5]+=t.ty;var r=i(n,function(t){return t.toFixed(6)});e.style[o(m)]="0 0",e.style[o(w)]="matrix("+r.join(",")+")"}function l(t,e){var n=M(e),i=parseFloat(n.left)||0,r=parseFloat(n.top)||0;"static"===n.position&&(e.style.position="relative"),e.style.left=i+t.tx+b,e.style.top=r+t.ty+b,e.style.height=t.height+b,e.style.width=t.width+b}function s(t,e){var n=M(e),i=parseFloat(n.marginLeft)||0,r=parseFloat(n.marginTop)||0;e.style.marginLeft=i+t.tx+b,e.style.marginTop=r+t.ty+b,e.style.height=t.height+b,e.style.width=t.width+b}function c(t,e){e.height*=t.scale,e.width*=t.scale,e.x+=t.tx,e.y+=t.ty}function g(t){if(t instanceof HTMLElement){var n=t.getBoundingClientRect();t={height:t.offsetHeight,width:t.offsetWidth,x:n.left,y:n.top}}return!e(t.x)&&e(t.left)&&(t.x=t.left),!e(t.y)&&e(t.top)&&(t.x=t.top),t}function h(){var t=n(),e=t-v;if(x>=e)clearInterval(d),d=setTimeout(h,x-e);else{for(var i=0,r=z.length;r>i;i++)z[i]();v=t}}function u(t,e,n,i,r){var o=g(t),a=g(e),l=o.width,s=o.height,h=a.width,u=a.height,p=h/l,y=u/s,v=l/s,d=h/u,x=n.cover?y:p,m=n.cover?p:y,w=v>=d?x:m,T=l*w,L=s*w,O=n.hAlign==F?.5*(T-h):n.hAlign==E?T-h:0,b=n.vAlign==F?.5*(L-u):n.vAlign==A?L-u:0;return r=r||{},r.tx=a.x-O-o.x,r.ty=a.y-b-o.y,r.x=a.x-O-o.x*w,r.y=a.y-b-o.y*w,r.height=o.height*w,r.width=o.width*w,r.scale=w,i?i(r,t):n.apply&&(i=t instanceof HTMLElement?f:c)(r,t),r}function p(t,e,n,i){if(!t||!e)throw"You must supply a target and a container";"function"==typeof n&&(i=n,n={}),n=r(n||{},N);var o=u(t,e,n,i);return n.watch&&(z.length||C.addEventListener("resize",h),o.trigger=function(){u(t,e,n,i,o)},o.on=function(t){var e=z.indexOf(o.trigger);~e||z.push(o.trigger),t||o.trigger()},o.off=function(){var t=z.indexOf(o.trigger);~t&&z.splice(t,1)},o.on(!0)),o}var y,v,d,x=50,m="TransformOrigin",w="Transform",T="moz ms o webkit".split(" "),F="center",A="bottom",E="right",L="left",O="top",b="px",C=window||self,H=document,M=C.getComputedStyle,z=[],N={hAlign:F,vAlign:F,watch:!1,cover:!1,apply:!0};return r(p,{watching:z,defaults:N,cssTransform:f,cssPosition:l,cssMargin:s,CENTER:F,BOTTOM:A,RIGHT:E,LEFT:L,TOP:O})}();