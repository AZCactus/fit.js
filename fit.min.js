/* Copyright (C) 2014 Justin Windle, http://soulwire.co.uk */
var fit=function(){"use strict";function t(t){return t.toUpperCase()}function e(t){return"number"==typeof t&&!isNaN(t)}function n(t,e){for(var n=[],i=0,r=t.length;r>i;i++)n[i]=e(t[i]);return n}function i(t,e){for(var n in e)n in t||(t[n]=e[n]);return t}function r(e){if(!p)for(var n,i=O(L.body),r=v,o=0,a=d.length;a>o&&(p=d[o],n=p+r,!(n in i))&&(p=p.replace(/^(\w)/,t),n=p+r,!(n in i));o++);return p+e}function o(t){var e=O(t),n=e[r(v)].replace(/[a-z()]/gi,"").split(",");if(n.length<6)return[1,0,0,1,0,0];for(var i=0;6>i;i++)n[i]=parseFloat(n[i]);return n}function a(t,e){var i=o(e);i[0]=t.scale,i[3]=t.scale,i[4]+=t.tx,i[5]+=t.ty;var a=n(i,function(t){return t.toFixed(6)});e.style[r(y)]="0 0",e.style[r(v)]="matrix("+a.join(",")+")"}function f(t,e){var n=O(e),i=parseFloat(n.left)||0,r=parseFloat(n.top)||0;"static"===n.position&&(e.style.position="relative"),e.style.left=i+t.tx+A,e.style.top=r+t.ty+A,e.style.height=t.height+A,e.style.width=t.width+A}function l(t,e){var n=O(e),i=parseFloat(n.marginLeft)||0,r=parseFloat(n.marginTop)||0;e.style.marginLeft=i+t.tx+A,e.style.marginTop=r+t.ty+A,e.style.height=t.height+A,e.style.width=t.width+A}function s(t,e){e.height*=t.scale,e.width*=t.scale,e.x+=t.tx,e.y+=t.ty}function h(t){if(t instanceof HTMLElement){var n=t.getBoundingClientRect();t={height:t.offsetHeight,width:t.offsetWidth,x:n.left,y:n.top}}return!e(t.x)&&e(t.left)&&(t.x=t.left),!e(t.y)&&e(t.top)&&(t.x=t.top),t}function c(){for(var t=0,e=b.length;e>t;t++)b[t]()}function g(t,e,n,i,r){var o=h(t),f=h(e),l=o.width,c=o.height,g=f.width,u=f.height,p=g/l,y=u/c,v=l/c,d=g/u,T=n.cover?y:p,F=n.cover?p:y,A=v>=d?T:F,E=l*A,L=c*A,O=n.hAlign==x?.5*(E-g):n.hAlign==m?E-g:0,b=n.vAlign==x?.5*(L-u):n.vAlign==w?L-u:0;return r=r||{},r.tx=f.x-O-o.x,r.ty=f.y-b-o.y,r.x=f.x-O-o.x*A,r.y=f.y-b-o.y*A,r.height=o.height*A,r.width=o.width*A,r.scale=A,i?i(r,t):n.apply&&(i=t instanceof HTMLElement?a:s)(r,t),r}function u(t,e,n,r){if(!t||!e)throw"You must supply a target and a container";"function"==typeof n&&(r=n,n={}),n=i(n||{},C);var o=g(t,e,n,r);return n.watch&&(b.length||E.addEventListener("resize",c),o.trigger=function(){g(t,e,n,r,o)},o.on=function(t){var e=b.indexOf(o.trigger);~e||b.push(o.trigger),t||o.trigger()},o.off=function(){var t=b.indexOf(o.trigger);~t&&b.splice(t,1)},o.on(!0)),o}var p,y="TransformOrigin",v="Transform",d="moz ms o webkit".split(" "),x="center",w="bottom",m="right",T="left",F="top",A="px",E=window||self,L=document,O=E.getComputedStyle,b=[],C={hAlign:x,vAlign:x,watch:!1,cover:!1,apply:!0};return i(u,{watching:b,defaults:C,cssTransform:a,cssPosition:f,cssMargin:l,CENTER:x,BOTTOM:w,RIGHT:m,LEFT:T,TOP:F})}();