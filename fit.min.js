/* Copyright (C) 2014 Justin Windle, http://soulwire.co.uk */
var fit=function(){"use strict";function t(t){return t.toUpperCase()}function e(t){return"number"==typeof t&&!isNaN(t)}function i(t,e){for(var i in e)i in t||(t[i]=e[i]);return t}function n(e){if(!u)for(var i,n=L(F.body),r=y,o=0,a=v.length;a>o&&(u=v[o],i=u+r,!(i in n))&&(u=u.replace(/^(\w)/,t),i=u+r,!(i in n));o++);return u+e}function r(t){var e=L(t),i=e[n(y)].replace(/[a-z()]/gi,"").split(",");if(i.length<6)return[1,0,0,1,0,0];for(var r=0;6>r;r++)i[r]=parseFloat(i[r]);return i}function o(t,e){var i=r(e);i[0]=t.scale,i[3]=t.scale,i[4]+=t.tx,i[5]+=t.ty,e.style[n(p)]="0 0",e.style[n(y)]="matrix("+i.join(",")+")"}function a(t,e){var i=L(e),n=parseFloat(i.left)||0,r=parseFloat(i.top)||0;"static"===i.position&&(e.style.position="relative"),e.style.left=n+t.tx+A,e.style.top=r+t.ty+A,e.style.height=t.height+A,e.style.width=t.width+A}function s(t,e){var i=L(e),n=parseFloat(i.marginLeft)||0,r=parseFloat(i.marginTop)||0;e.style.marginLeft=n+t.tx+A,e.style.marginTop=r+t.ty+A,e.style.height=t.height+A,e.style.width=t.width+A}function f(t,e){e.height*=t.scale,e.width*=t.scale,e.x+=t.tx,e.y+=t.ty}function l(t){if(t instanceof HTMLElement){var i=t.getBoundingClientRect();t={height:t.offsetHeight,width:t.offsetWidth,x:i.left,y:i.top}}return!e(t.x)&&e(t.left)&&(t.x=t.left),!e(t.y)&&e(t.top)&&(t.x=t.top),t}function h(){for(var t=0,e=O.length;e>t;t++)O[t]()}function g(t,e,i,n,r){var a=l(t),s=l(e),h=a.width,g=a.height,c=s.width,u=s.height,p=c/h,y=u/g,v=h/g,m=c/u,T=i.cover?y:p,A=i.cover?p:y,E=v>=m?T:A,F=h*E,L=g*E,O=i.hAlign==d?.5*(F-c):i.hAlign==w?F-c:0,b=i.vAlign==d?.5*(L-u):i.vAlign==x?L-u:0;return r=r||{},r.tx=s.x-O-a.x,r.ty=s.y-b-a.y,r.x=s.x-O-a.x*E,r.y=s.y-b-a.y*E,r.height=a.height*E,r.width=a.width*E,r.scale=E,n?n(r,t):i.apply&&(n=t instanceof HTMLElement?o:f)(r,t),r}function c(t,e,n,r){if(!t||!e)throw"You must supply a target and a container";"function"==typeof n&&(r=n,n={}),n=i(n||{},b);var o=g(t,e,n,r);return n.watch&&(O.length||E.addEventListener("resize",h),o.trigger=function(){g(t,e,n,r,o)},o.on=function(t){var e=O.indexOf(o.trigger);~e||O.push(o.trigger),t||o.trigger()},o.off=function(){var t=O.indexOf(o.trigger);~t&&O.splice(t,1)},o.on(!0)),o}var u,p="TransformOrigin",y="Transform",v="moz ms o webkit".split(" "),d="center",x="bottom",w="right",m="left",T="top",A="px",E=window||self,F=document,L=E.getComputedStyle,O=[],b={hAlign:d,vAlign:d,watch:!1,cover:!1,apply:!0};return i(c,{watching:O,defaults:b,cssTransform:o,cssPosition:a,cssMargin:s,CENTER:d,BOTTOM:x,RIGHT:w,LEFT:m,TOP:T})}();